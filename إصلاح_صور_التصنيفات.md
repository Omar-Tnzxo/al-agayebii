# ุฅุตูุงุญ ูุดููุฉ ุตูุฑ ุงูุชุตูููุงุช

## ุงููุดููุฉ ุงููุจูุบ ุนููุง

ุนูุฏ ุฅุถุงูุฉ ุฃู ุชุนุฏูู ุชุตููู ูู `/dashboard/categories`:
- ูุชู ุงุฎุชูุงุฑ ุงูุตูุฑุฉ ุจูุฌุงุญ
- ุชุธูุฑ ุงูุตูุฑุฉ ูู ุงููุนุงููุฉ
- ุนูุฏ ุงูุญูุธุ ูุชู ุฑูุน ุงูุตูุฑุฉ ุนูู Supabase Storage
- **ููู** ูุง ูุชู ุฑุจุท ุงูุตูุฑุฉ ุจุงูุชุตููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุชุตููู ูุธูุฑ ุจุฏูู ุตูุฑุฉ

## ุงูุชุบููุฑุงุช ุงููุทุจูุฉ

### 1. ุฅุถุงูุฉ Logging ุดุงูู

ุชู ุฅุถุงูุฉ `console.log` ูู ุฌููุน ูุฑุงุญู ุงูุนูููุฉ ูุชุชุจุน ุงูุจูุงูุงุช:

#### ุฃ) ูู ูููู ุฑูุน ุงูุตูุฑ (`components/ImageUpload.tsx`)
```typescript
// ุนูุฏ ุงุฎุชูุงุฑ ุงูุตูุฑุฉ
console.log('๐ผ๏ธ ุชู ุงุฎุชูุงุฑ ููู:', { name, size, type });

// ุนูุฏ ุจุฏุก ุงูุฑูุน
console.log('๐ค ุจุฏุก ุฑูุน ุงูุตูุฑุฉ...');

// ุนูุฏ ูุฌุงุญ ุงูุฑูุน
console.log('โ ุชู ุฑูุน ุงูุตูุฑุฉ ุจูุฌุงุญ:', result.imageUrl);
console.log('๐ข ุงุณุชุฏุนุงุก onImageUploaded ูุน URL:', result.imageUrl);
```

#### ุจ) ูู ุตูุญุฉ ุฅุถุงูุฉ ุชุตููู (`app/dashboard/categories/new/page.tsx`)
```typescript
// ุนูุฏ ุชุญุฏูุซ state
console.log('๐ฅ ุชุญุฏูุซ ุตูุฑุฉ ุงูุชุตููู ูู state:', imageUrl);

// ูุจู ุฅุฑุณุงู ุงูุจูุงูุงุช
console.log('๐ค ุฅุฑุณุงู ุจูุงูุงุช ุงูุชุตููู ุงูุฌุฏูุฏ:', payload);
```

#### ุฌ) ูู ุตูุญุฉ ุชุนุฏูู ุชุตููู (`app/dashboard/categories/edit/[type]/page.tsx`)
```typescript
// ุนูุฏ ุชุญุฏูุซ state
console.log('๐ฅ ุชุญุฏูุซ ุตูุฑุฉ ุงูุชุตููู ูู state:', url);

// ูุจู ุฅุฑุณุงู ุงูุจูุงูุงุช
console.log('๐ค ุฅุฑุณุงู ุจูุงูุงุช ุชุญุฏูุซ ุงูุชุตููู:', payload);
```

#### ุฏ) ูู API ุงูุฅุถุงูุฉ (`app/api/categories/route.ts`)
```typescript
// ุนูุฏ ุงุณุชูุงู ุงูุจูุงูุงุช
console.log('๐ ูุญุงููุฉ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ:', { name, type, description, image, is_active, sort_order });

// ุนูุฏ ุงููุฌุงุญ
console.log('โ ุชู ุฅุถุงูุฉ ุงูุชุตููู ุจูุฌุงุญ:', data);

// ุนูุฏ ุงููุดู
console.error('โ ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูุชุตููู:', error);
```

#### ูู) ูู API ุงูุชุญุฏูุซ (`app/api/categories/[type]/route.ts`)
```typescript
// ุนูุฏ ุงุณุชูุงู ุงูุจูุงูุงุช
console.log('๐ ุจูุงูุงุช ุงูุชุญุฏูุซ ุงููุณุชููุฉ:', body);

// ุงูุญููู ุงููุฑุงุฏ ุชุญุฏูุซูุง
console.log('๐ ุงูุญููู ุงููุฑุงุฏ ุชุญุฏูุซูุง:', updateFields);

// ุนูุฏ ุงููุฌุงุญ
console.log('โ ุชู ุชุญุฏูุซ ุงูุชุตููู ุจูุฌุงุญ:', updatedData);

// ุนูุฏ ุงููุดู
console.error('โ ุฎุทุฃ ูู ุชุญุฏูุซ ุงูุชุตููู:', error);
```

## ููููุฉ ุงูุชุดุฎูุต

### ุงูุฎุทูุฉ 1: ุชุดุบูู Development Server

```bash
npm run dev
```

### ุงูุฎุทูุฉ 2: ูุชุญ Console ูู ุงููุชุตูุญ

1. ุงูุชุญ ุงููุชุตูุญ ุนูู `http://localhost:3000`
2. ุงุถุบุท `F12` ููุชุญ Developer Tools
3. ุงูุชูู ุฅูู tab "Console"

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุฅุถุงูุฉ ุชุตููู

1. ุงุฐูุจ ุฅูู `/dashboard/categories/new`
2. ุงููุฃ ุฌููุน ุงูุญููู:
   - ุงูุงุณู: ูุซูุงู "ุชุตููู ุชุฌุฑูุจู"
   - ุงูููุน: ูุซูุงู "test-category"
   - ุงููุตู: ุฃู ูุตู
   - ุงุฎุชุฑ ุตูุฑุฉ
3. ุฑุงูุจ Console ูู ุงููุชุตูุญุ ูุฌุจ ุฃู ุชุฑู:
   ```
   ๐ผ๏ธ ุชู ุงุฎุชูุงุฑ ููู: ...
   ๐ค ุจุฏุก ุฑูุน ุงูุตูุฑุฉ...
   โ ุชู ุฑูุน ุงูุตูุฑุฉ ุจูุฌุงุญ: https://...
   ๐ข ุงุณุชุฏุนุงุก onImageUploaded ูุน URL: https://...
   ๐ฅ ุชุญุฏูุซ ุตูุฑุฉ ุงูุชุตููู ูู state: https://...
   ```
4. ุงุถุบุท "ุญูุธ"
5. ุฑุงูุจ Consoleุ ูุฌุจ ุฃู ุชุฑู:
   ```
   ๐ค ุฅุฑุณุงู ุจูุงูุงุช ุงูุชุตููู ุงูุฌุฏูุฏ: { ..., image: "https://...", ... }
   ```
6. ุฑุงูุจ Terminal ุญูุซ ูุนูู dev serverุ ูุฌุจ ุฃู ุชุฑู:
   ```
   POST /api/categories
   ๐ ูุญุงููุฉ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ: { ..., image: "https://...", ... }
   โ ุชู ุฅุถุงูุฉ ุงูุชุตููู ุจูุฌุงุญ: { ..., image: "https://...", ... }
   ```

### ุงูุฎุทูุฉ 4: ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุงุณุชุฎุฏู ุงูููู `check-categories-images.sql` ููุชุญูู ูู ุงูุจูุงูุงุช:

```sql
-- ุนุฑุถ ุงูุชุตููู ุงูุฌุฏูุฏ
SELECT id, name, type, image, created_at
FROM categories
WHERE type = 'test-category';
```

## ุงูุณููุงุฑูููุงุช ุงููุญุชููุฉ

### ุงูุณููุงุฑูู 1: ุงูุตูุฑุฉ ูุง ุชูุฑูุน ุฃุตูุงู

**ุงูุฃุนุฑุงุถ:**
- ูุง ุชุธูุฑ ุฑุณุงูุฉ `โ ุชู ุฑูุน ุงูุตูุฑุฉ ุจูุฌุงุญ`
- ุฃู ุชุธูุฑ ุฑุณุงูุฉ ุฎุทุฃ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. ูุดููุฉ ูู Supabase Storage configuration
2. ูุชุบูุฑุงุช ุงูุจูุฆุฉ ููููุฏุฉ ุฃู ุฎุงุทุฆุฉ
3. Bucket ุบูุฑ ููุฌูุฏ ุฃู Permissions ุฎุงุทุฆุฉ

**ุงูุญู:**
1. ุชุญูู ูู `.env.local`:
   ```
   NEXT_PUBLIC_SUPABASE_URL=...
   SUPABASE_SERVICE_ROLE_KEY=...
   ```
2. ุชุญูู ูู ูุฌูุฏ bucket ุงุณูู `product-images` ูู Supabase Storage
3. ุชุญูู ูู Permissions (ูุฌุจ ุฃู ูููู public)

### ุงูุณููุงุฑูู 2: ุงูุตูุฑุฉ ุชูุฑูุน ููู ูุง ุชูุญูุธ ูู State

**ุงูุฃุนุฑุงุถ:**
- ุชุธูุฑ ุฑุณุงูุฉ `โ ุชู ุฑูุน ุงูุตูุฑุฉ ุจูุฌุงุญ`
- ููู ูู `๐ค ุฅุฑุณุงู ุจูุงูุงุช ุงูุชุตููู`ุ ุญูู `image` ูููู ูุงุฑุบูุง ุฃู `""`

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ูุดููุฉ ูู React state management
- callback `onImageUploaded` ูุง ูุนูู ุจุดูู ุตุญูุญ

**ุงูุญู:**
- ุชุญูู ูู logs ููุชุฃูุฏ ูู ุฃู `๐ฅ ุชุญุฏูุซ ุตูุฑุฉ ุงูุชุตููู ูู state` ุชุธูุฑ ูุน URL ุตุญูุญ
- ุฅุฐุง ูู ุชุธูุฑุ ุงููุดููุฉ ูู callback

### ุงูุณููุงุฑูู 3: ุงูุจูุงูุงุช ุชูุฑุณู ููู ูุง ุชูุญูุธ ูู Database

**ุงูุฃุนุฑุงุถ:**
- ูู Console: `๐ค ุฅุฑุณุงู ุจูุงูุงุช ุงูุชุตููู` ูุญุชูู ุนูู `image` ุตุญูุญ
- ูู Terminal: `๐ ูุญุงููุฉ ุฅุถุงูุฉ ุชุตููู` ูุญุชูู ุนูู `image` ุตุญูุญ
- ููู `โ ุชู ุฅุถุงูุฉ ุงูุชุตููู ุจูุฌุงุญ` ููุธูุฑ `image: null` ุฃู ุจุฏูู ุญูู image

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. ูุดููุฉ ูู database schema (ุงูุนููุฏ `image` ุบูุฑ ููุฌูุฏ ุฃู ููุนู ุฎุงุทุฆ)
2. ูุดููุฉ ูู Supabase RLS policies
3. ุฎุทุฃ ูู SQL query

**ุงูุญู:**
```sql
-- ุชุญูู ูู ูุฌูุฏ ุนููุฏ image
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'categories' AND column_name = 'image';

-- ุฅุฐุง ูู ููู ููุฌูุฏูุงุ ุฃุถูู:
ALTER TABLE categories ADD COLUMN IF NOT EXISTS image text;

-- ุชุญูู ูู RLS policies
SELECT * FROM pg_policies WHERE tablename = 'categories';
```

### ุงูุณููุงุฑูู 4: ูู ุดูุก ูุนูู ูู Logs ููู ุงูุตูุฑุฉ ูุง ุชุธูุฑ

**ุงูุฃุนุฑุงุถ:**
- ุฌููุน logs ุชุธูุฑ ุจุดูู ุตุญูุญ
- Database ูุญุชูู ุนูู URL ุงูุตูุฑุฉ
- ููู ุงูุตูุฑุฉ ูุง ุชุธูุฑ ูู ุงููุงุฌูุฉ

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ูุดููุฉ ูู ุนุฑุถ ุงูุตูุฑุฉ (Image component)
- ุงูุตูุฑุฉ ูุญุธูุฑุฉ (CORS issue)
- URL ุงูุตูุฑุฉ ุฎุงุทุฆ ุฃู ููุชูู

**ุงูุญู:**
1. ุฌุฑูุจ ูุชุญ URL ุงูุตูุฑุฉ ูุจุงุดุฑุฉ ูู ุงููุชุตูุญ
2. ุชุญูู ูู Supabase Storage policies (ูุฌุจ ุฃู ุชููู public ูููุฑุงุกุฉ)
3. ุชุญูู ูู Next.js image domains configuration

## ุงููููุงุช ุงููุถุงูุฉ

1. **CATEGORY_IMAGE_DEBUG.md** - ุฏููู ุงูุชุดุฎูุต ุจุงูุฅูุฌููุฒูุฉ
2. **ุฅุตูุงุญ_ุตูุฑ_ุงูุชุตูููุงุช.md** - ูุฐุง ุงูููู (ุฏููู ุจุงูุนุฑุจูุฉ)
3. **check-categories-images.sql** - ุงุณุชุนูุงูุงุช SQL ูููุญุต

## ุงููููุงุช ุงููุนุฏูุฉ

1. `components/ImageUpload.tsx` - ุฅุถุงูุฉ logging
2. `app/dashboard/categories/new/page.tsx` - ุฅุถุงูุฉ logging
3. `app/dashboard/categories/edit/[type]/page.tsx` - ุฅุถุงูุฉ logging
4. `app/api/categories/route.ts` - ุฅุถุงูุฉ logging
5. `app/api/categories/[type]/route.ts` - ุฅุถุงูุฉ logging

## ุจุนุฏ ุญู ุงููุดููุฉ

ุนูุฏูุง ุชุญุฏุฏ ุงููุดููุฉ ูุชุญููุงุ ููููู:

1. ุฅุฒุงูุฉ ุฌููุน ุฃุณุทุฑ `console.log` ูู ุงููููุงุช
2. ุญุฐู ูููุงุช ุงูุชูุซูู ุฅุฐุง ุฃุฑุฏุช
3. ุนูู commit ููุงุฆู:

```bash
git add .
git commit -m "fix: resolve category image upload and save issue"
git push
```

## ุงููุณุงุนุฏุฉ ุงูุฅุถุงููุฉ

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ ุจุนุฏ ุงุชุจุงุน ูุฐู ุงูุฎุทูุงุช:

1. ุงูุณุฎ ุฌููุน logs ูู Console ู Terminal
2. ูู ุจุชุดุบูู ุงูุงุณุชุนูุงูุงุช ูู `check-categories-images.sql`
3. ุฃุฑุณู ุงููุชุงุฆุฌ ูููุฑุงุฌุนุฉ

---

**ุชุงุฑูุฎ ุงูุฅุถุงูุฉ:** 2025-10-14
**ุงูุญุงูุฉ:** ุชู ุฅุถุงูุฉ logging ุดุงููุ ูู ุงูุชุธุงุฑ ุงูุงุฎุชุจุงุฑ
